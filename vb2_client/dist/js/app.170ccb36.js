(function(e){function t(t){for(var s,a,c=t[0],u=t[1],l=t[2],d=0,p=[];d<c.length;d++)a=c[d],Object.prototype.hasOwnProperty.call(n,a)&&n[a]&&p.push(n[a][0]),n[a]=0;for(s in u)Object.prototype.hasOwnProperty.call(u,s)&&(e[s]=u[s]);i&&i(t);while(p.length)p.shift()();return o.push.apply(o,l||[]),r()}function r(){for(var e,t=0;t<o.length;t++){for(var r=o[t],s=!0,c=1;c<r.length;c++){var u=r[c];0!==n[u]&&(s=!1)}s&&(o.splice(t--,1),e=a(a.s=r[0]))}return e}var s={},n={app:0},o=[];function a(t){if(s[t])return s[t].exports;var r=s[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,a),r.l=!0,r.exports}a.m=e,a.c=s,a.d=function(e,t,r){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(a.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)a.d(r,s,function(t){return e[t]}.bind(null,s));return r},a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],u=c.push.bind(c);c.push=t,c=c.slice();for(var l=0;l<c.length;l++)t(c[l]);var i=u;o.push([0,"chunk-vendors"]),r()})({0:function(e,t,r){e.exports=r("56d7")},"56d7":function(e,t,r){"use strict";r.r(t);var s=r("7a23");function n(e,t,r,n,o,a){const c=Object(s["n"])("User");return Object(s["k"])(),Object(s["e"])("div",null,[Object(s["h"])(c)])}const o={key:0},a={key:0},c=Object(s["f"])("h1",null,"Admin",-1),u={key:1},l={key:0},i=Object(s["f"])("hr",null,null,-1),d=Object(s["f"])("hr",null,null,-1),p={key:1},b=Object(s["f"])("br",null,null,-1),O=Object(s["f"])("br",null,null,-1),j=Object(s["f"])("br",null,null,-1),f=Object(s["f"])("br",null,null,-1),h=Object(s["f"])("br",null,null,-1),m={key:0};function k(e,t,r,n,k,v){const g=Object(s["n"])("UpdatableTask");return Object(s["k"])(),Object(s["e"])("div",null,[Object(s["f"])("div",null,[e.$store.state.user?(Object(s["k"])(),Object(s["e"])("div",o,[e.$store.state.user.roles.includes("admin")?(Object(s["k"])(),Object(s["e"])("div",a,[c,Object(s["f"])("pre",null,Object(s["o"])(e.$store.state.user),1)])):e.$store.state.user.roles.includes("user")?(Object(s["k"])(),Object(s["e"])("div",u,[Object(s["f"])("h1",null,"User: "+Object(s["o"])(e.$store.state.user.username),1),Object(s["f"])("button",{onClick:t[0]||(t[0]=(...e)=>v.retrieveOwnTasks&&v.retrieveOwnTasks(...e))},"Retrieve my tasks"),e.$store.state.tasks.length?(Object(s["k"])(),Object(s["e"])("div",l,[i,(Object(s["k"])(!0),Object(s["e"])(s["a"],null,Object(s["m"])(e.$store.state.tasks,(e,t)=>(Object(s["k"])(),Object(s["e"])("div",null,[Object(s["h"])(g,{task:e,index:t},null,8,["task","index"])]))),256))])):Object(s["d"])("",!0)])):Object(s["d"])("",!0),Object(s["f"])("div",null,[d,Object(s["f"])("button",{onClick:t[1]||(t[1]=(...e)=>v.logout&&v.logout(...e))},"Log out")])])):(Object(s["k"])(),Object(s["e"])("div",p,[Object(s["g"])(" username:"),b,Object(s["s"])(Object(s["f"])("input",{type:"text","onUpdate:modelValue":t[2]||(t[2]=e=>k.user.username=e)},null,512),[[s["q"],k.user.username]]),O,Object(s["g"])(" password:"),j,Object(s["s"])(Object(s["f"])("input",{type:"password","onUpdate:modelValue":t[3]||(t[3]=e=>k.user.password=e)},null,512),[[s["q"],k.user.password]]),f,h,Object(s["f"])("button",{onClick:t[4]||(t[4]=(...e)=>v.login&&v.login(...e))},"Login")]))]),e.$store.state.error?(Object(s["k"])(),Object(s["e"])("div",m,Object(s["o"])(e.$store.state.error),1)):Object(s["d"])("",!0)])}function v(e,t,r,n,o,a){return Object(s["k"])(),Object(s["e"])("div",null,[Object(s["f"])("div",null,[Object(s["g"])(Object(s["o"])(r.task.todo)+" ",1),Object(s["s"])(Object(s["f"])("input",{onChange:t[0]||(t[0]=(...e)=>a.update&&a.update(...e)),type:"checkbox",id:"completed",value:"completed","onUpdate:modelValue":t[1]||(t[1]=e=>o.completed=e)},null,544),[[s["p"],o.completed]])])])}var g={name:"UpdatableTask",props:["index","task"],data(){return{completed:this.task.completed}},methods:{update:function(){this.$store.dispatch("changeCompletedOfTask",{index:this.index,completed:this.completed})}}},y=r("6b0d"),w=r.n(y);const _=w()(g,[["render",v]]);var $=_,x={name:"User",components:{UpdatableTask:$},data(){return{user:{username:"",password:""}}},methods:{login:function(){this.$store.dispatch("login",{username:this.user.username,password:this.user.password})},logout:function(){this.$store.dispatch("logout")},retrieveOwnTasks:function(){this.$store.dispatch("retrieveOwnTasks")}},beforeMount(){this.$store.dispatch("checkLogin")}};const T=w()(x,[["render",k]]);var U=T,C={name:"app",components:{User:U}};const E=w()(C,[["render",n]]);var P=E,M=r("5502"),S=r("bc3a"),L=r.n(S);let V="http://localhost:3000";var q=Object(M["a"])({state:{user:null,tasks:[],error:""},actions:{login:async function({commit:e,state:t},r){try{const t=r.username,s=r.password;e("_reset");const n={withCredentials:"true"},o=await L.a.post(V+"/user/login",{username:t,password:s},n);e("_updateUser",o.data.user)}catch(s){e("_updateError",s.message)}},logout:async function({commit:e,state:t},r){try{e("_reset");const t={withCredentials:"true"};await L.a.post(V+"/user/logout",{},t)}catch(s){e("_updateError",s.message)}},checkLogin:async function({commit:e,state:t}){try{e("_reset");const t={withCredentials:"true"},r=await L.a.post(V+"/user/login/check",{},t);e("_updateUser",r.data.user)}catch(r){}},retrieveOwnTasks:async function({commit:e,state:t}){try{e("_updateError","");const r={withCredentials:"true"};let s=await L.a.get(`${V}/user/${t.user._id}/task`,r);e("_updateTasks",s.data)}catch(r){e("_updateError",r.message)}},changeCompletedOfTask:async function({commit:e,state:t},r){try{e("_updateError","");const s=r.index,n=r.completed,o=t.tasks[s]._id,a={withCredentials:"true"};await L.a.patch(`${V}/user/${t.user._id}/task/${o}`,{completed:n},a);e("_updateTask",{index:s,completed:n})}catch(s){e("_updateError",s.message)}}},mutations:{_reset(e){e.user=null,e.tasks=[],e.error=""},_updateUser(e,t){e.user=t},_updateError(e,t){e.error=t},_updateTasks(e,t){e.tasks=[],e.tasks=t},_updateTask(e,t){e.tasks[t.index].completed=t.completed}}});Object(s["c"])(P).use(q).mount("#app")}});
//# sourceMappingURL=app.170ccb36.js.map